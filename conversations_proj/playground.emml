<mashup xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.openmashup.org/schemas/v1.0/EMML/../schemas/EMMLPrestoSpec.xsd"
	xmlns="http://www.openmashup.org/schemas/v1.0/EMML" xmlns:macro="http://www.openmashup.org/schemas/v1.0/EMMLMacro"
	xmlns:presto="http://www.jackbe.com/v1.0/EMMLPrestoExtensions" name="conversations_parser_feed">
	<operation name="invoke">
		<output name="result" type="document" />

		<variables>
			<variable name="config" type="document">
				<item>
					<guid isPermaLink="false">www.facebook.com/notification/e2f5a0673817d5350e7c4461fb8fe4da</guid>
					<title> Check out The Escape - espionage, chases, fists flying and
						cool gadgets - Do you
						have what it takes? http://pub.vitrue.com/ZWp</title>
					<link>http://www.facebook.com/Intel/posts/10150208111766850</link>
					<description>Check out The Escape - espionage, chases, fists
						flying and cool gadgets - Do
						you have what it takes? &lt;a href=&quot;http://pub.vitrue.com/ZWp&quot;
            onmousedown=&quot;UntrustedLink.bootstrap($(this), &quot;00744&quot;, event,
            bagof({}));&quot; rel=&quot;nofollow&quot;
            target=&quot;_blank&quot;&gt;http://pub.vitrue.com/ZWp&lt;/a&gt;&lt;br/&gt;&lt;br/&gt;&lt;a
            href=&quot;&quot; id=&quot;&quot; title=&quot;&quot; target=&quot;&quot;
            onclick=&quot;&quot; style=&quot;&quot;&gt;&lt;/a&gt;&lt;br/&gt;&lt;br/&gt;&lt;a
            href=&quot;http://pub.vitrue.com/ZWp&quot; id=&quot;&quot; target=&quot;_blank&quot;
            style=&quot;&quot; onmousedown=&quot;UntrustedLink.bootstrap($(this), &quot;00744&quot;,
            event, bagof({}));&quot; rel=&quot;nofollow&quot;&gt;IntelÂ® presents The
            Escape&lt;/a&gt;&lt;br/&gt;Source: pub.vitrue.com</description>
        <pubDate>Mon, 20 Jun 2011 21:05:09 +0400</pubDate>
        <author>Intel</author>

    </item>
    <item>
        <guid isPermaLink="false"
            >www.facebook.com/notification/bb81b4c889fb831dfa57ec0e503d2dac</guid>
        <title> Watch Intel leaders tell the story of Intel&apos;s journey ahead - Defining the next
            era of personal computing!</title>
        <link>http://www.facebook.com/Intel/posts/10150201797026850</link>
        <description>Watch Intel leaders tell the story of Intel&apos;s journey ahead - Defining the
            next era of personal computing!&lt;br/&gt;&lt;br/&gt;&lt;a href=&quot;&quot;
            id=&quot;&quot; title=&quot;&quot; target=&quot;&quot; onclick=&quot;&quot;
            style=&quot;&quot;&gt;&lt;/a&gt;&lt;br/&gt;</description>
        <pubDate>Fri, 10 Jun 2011 20:23:21 +0100</pubDate>
        <author>Intel</author>

    </item>
        	</variable>
        	<variable name="pubDates" type="string" default=""></variable>
        	<variable name="xx" type="string" default=""></variable>
        	<variable name="date_string" type="string" default=""></variable>
        	
        	
        </variables>
        
        
        <assign fromexpr="$config//pubDate/string()" outputvariable="pubDates"/>
        
        <display message="Pubdates:" variable="pubDates"/>
         
        
        <script>
 	 	<![CDATA[
 	 		//Break date and time
 	 		var date_time_split = pubDates.split(" ");
 	 	
 	 		//Construct Date
 	 		var year = date_time_split[3];
 	 		var month = date_time_split[2];
 	 		var day = date_time_split[1];
 	 		
 	 		if(month == 'Jan') month = "01"
 	 		else if(month == 'Feb') month = "02"
 	 		else if(month == 'Mar') month = "03"
 	 		else if(month == 'Abr') month = "04"
 	 		else if(month == 'May') month = "05"
 	 		else if(month == 'Jun') month = "06"
 	 		else if(month == 'Jul') month = "07"
 	 		else if(month == 'Aug') month = "08"
 	 		else if(month == 'Sep') month = "09"
 	 		else if(month == 'Oct') month = "10"
 	 		else if(month == 'Nov') month = "11"
 	 		else if(month == 'Dec') month = "12"
 	 		 		
 	 		//Construct Time
 	 		var time = date_time_split[4];
 	 		var time_split = time.split(":");
 	 		var hour = time_split[0];
 	 		var min = time_split[1];
 	 		var sec = time_split[2];
 	 		
 	 		//Create Date-Time javascript obj
 	 		var today = new Date();
 	 		var that_date = new Date(year, month-1, day, hour, min, sec); //Month is zero based index
 	 		print("that_date:" + that_date);
 	 		
 	 		var date_difference_milisecs = today - that_date
 	 		
 	 		var days_difference = parseInt( date_difference_milisecs / 86400000)
 	 		//print("days_difference:" + days_difference);
 	 		
 	 		var final_result = days_difference
 	 		
 	 		if( final_result == 0){
 	 			//Get hours then
 	 			var hours = parseInt(date_difference_milisecs / 3600000)
 	 			
 	 			//print("Hours:"+hours);
 	 			
 	 			final_result = hours
 	 			
 	 			if(final_result == 0){
 	 				//Then get Minutes
 	 				var mins = parseInt(date_difference_milisecs / 60000)
 	 				
 	 				final_result = mins + " minutes ago"
 	 				
 	 				print("Mins:"+ final_result);
 	 				
 	 			}
 	 			else{
 	 				//Return hours ago
 	 				final_result += " Hours ago"
 	 			}
 	 		}	
 	 		else{
 	 			//Return days ago
 	 			final_result += " Days ago"
 	 		}
 	 		
 	 		print("final_result:"+final_result);
		]]>
	</script>
	
			
		
    </operation>
</mashup>
