<mashup xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.openmashup.org/schemas/v1.0/EMML/../schemas/EMMLPrestoSpec.xsd"
	xmlns="http://www.openmashup.org/schemas/v1.0/EMML" xmlns:macro="http://www.openmashup.org/schemas/v1.0/EMMLMacro"
	xmlns:presto="http://www.jackbe.com/v1.0/EMMLPrestoExtensions" name="conversations_parser_feed">
	<operation name="invoke">
		<output name="result" type="document" />

		<variables>
			<variable name="mashup_almost_ready" type="document">
				<xx>
					<item>
						<entry>Intel Rapid Storage Manager Misidentified Drive</entry>
						<datetotext>33 minutes ago</datetotext>
						<source>rss</source>
						<link>http://communities.intel.com/thread/23130</link>
						<author>webadmin@intel.com</author>
						<created_time>Thu, 07 Jul 2011 14:30:31 GMT</created_time>
					</item>
					<item>
						<entry>How to change DP35DP to DP67BG keep hard drive?</entry>
						<datetotext>34 minutes ago</datetotext>
						<source>rss</source>
						<link>http://communities.intel.com/thread/23118</link>
						<author>webadmin@intel.com</author>
						<created_time>Thu, 07 Jul 2011 14:29:31 GMT</created_time>
					</item>
					<item>
						<entry>Compatible</entry>
						<datetotext>58 minutes ago</datetotext>
						<source>rss</source>
						<link>http://communities.intel.com/thread/22383</link>
						<author>webadmin@intel.com</author>
						<created_time>Thu, 07 Jul 2011 14:05:31 GMT</created_time>
					</item>
					<item>
						<entry>Intelinside: RT @laptopmag Sony VAIO S
							VPCSA290X (2011) http://bit.ly/nfZ5Am #2ndgen</entry>
						<created_time>2011-07-06T19:25:49+00:00</created_time>
						<source>twitter</source>
						<link href="http://twitter.com/Intelinside/statuses/88690131996905472" />
					</item>

				</xx>
			</variable>
		</variables>

		<variable name="each_created_time" type="string"></variable>
		<variable name="timestamp_arr" type="string" default=""></variable>

		<script>
			<![CDATA[
				timestamp_arr = [];
			]]>
		</script>


		<foreach items="$mashup_almost_ready//item" variable="item">
			<assign fromexpr="$item/created_time/node()" outputvariable="each_created_time" />


			<script>
	 	 	<![CDATA[
	 	 		var created_time_split = each_created_time.split(" ");
	 	 		
	 	 		//if created_time_split.length ==1 then it is alrady a timestamp (like twitter and atom feeds)
	 	 		if (created_time_split.length == 1){
	 	 			timestamp_arr.push(created_time_split[0]);
	 	 		}
	 	 		else{
	 	 			//print("each_created_time:" + each_created_time);
		 	 		print("created_time_split:" + created_time_split);
		 	 		
		 	 		//Format Needed: 2011-07-06T19:25:49+00:00
		 	 		var year = created_time_split[3];
		 	 		var month = created_time_split[2]; //Comes in letter
		 	 		var day = created_time_split[1];
		 	 		
		 	 		if(month == "Jan") month = "01";
					else if(month == "Feb") month = "02";
					else if(month == "Mar") month = "03";
					else if(month == "Abr") month = "04";
					else if(month == "May") month = "05";
					else if(month == "Jun") month = "06";
					else if(month == "Jul") month = "07";
					else if(month == "Aug") month = "08";
					else if(month == "Sep") month = "09";
					else if(month == "Oct") month = "10";
					else if(month == "Nov") month = "11";
					else if(month == "Dec") month = "12";
		 	 		
		 	 		print("year:"+year);
		 	 		print("month:"+month);
		 	 		print("day:"+day);
		 	 		
		 	 		var time_split = created_time_split[4].split(":");
		 	 		print("time_split:" + time_split);
		 	 		
		 	 		var hour = time_split[0];
		 	 		var minutes = time_split[1];
		 	 		var seconds = time_split[2];
		 	 		
		 	 		var timestamp = year +"-"+ month +"-"+ day +"T"+ hour +":"+ minutes +":"+ seconds + "+00:00"; 
		 	 		print("timestamp:"+ timestamp)
		 	 		
		 	 		timestamp_arr.push(timestamp);
		 	 			
	 	 		}
	 	 		
	 	 			 	    	
			]]>
			</script>

		</foreach>

		<display message="timestamp_arr:" variable="timestamp_arr" />
	</operation>
</mashup>
